{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Maven: clean install (root)",
      "type": "shell",
      "command": "mvn clean install",
      "problemMatcher": ["$maven"],
      "group": { "kind": "build", "isDefault": true },
      "presentation": { "reveal": "always" }
    },
    {
      "label": "Maven: package (Example/honeycomb-example)",
      "type": "shell",
      "command": "mvn -f Example/honeycomb-example/pom.xml clean package -DskipTests",
      "problemMatcher": ["$maven"],
      "presentation": { "reveal": "always" }
    }
    ,
    {
      "label": "Spring Boot: run (honeycomb)",
      "type": "shell",
      "command": "mvn -DskipTests spring-boot:run",
      "problemMatcher": ["$maven"],
      "presentation": { "reveal": "always" }
    },
    {
      "label": "Spring Boot: run (honeycomb-example)",
      "type": "shell",
      "command": "mvn -f Example/honeycomb-example/pom.xml -DskipTests spring-boot:run",
      "problemMatcher": ["$maven"],
      "presentation": { "reveal": "always" },
      "options": { "cwd": "${workspaceFolder}/Example/honeycomb-example" }
    }
    ,
    {
      "label": "Smoke tests (curl)",
      "type": "shell",
      "command": "bash",
      "args": [
        "-lc",
        "BASE=${BASE_URL:-http://localhost:8080}; KEY=${API_KEY:-admin-key}; echo 'Running smoke tests against' $BASE; \
        echo 'GET /honeycomb/cells'; curl -i -H \"X-API-Key: $KEY\" $BASE/honeycomb/cells; \
        echo; echo 'GET /cells/addresses'; curl -i -H \"X-API-Key: $KEY\" $BASE/cells/addresses; \
        echo; echo 'POST /cells/addresses (example)'; curl -i -X POST -H \"Content-Type: application/json\" -H \"X-API-Key: $KEY\" -d '{\"host\":\"127.0.0.1\",\"port\":8080,\"protocol\":\"http\"}' $BASE/cells/addresses"
      ],
      "problemMatcher": [],
      "presentation": { "reveal": "always", "panel": "shared" },
      "options": { "cwd": "${workspaceFolder}" }
    }
  ]
}
